# AqSolPred

A quaility-oriented data selection method for aqueous solubility prediction developed by Murat Cihan Sorkun.

> Autonomous Energy Materials Discovery [AMD] research group

> Dutch Institute for Fundamental Energy Research (DIFFER)

> Center for Computational Energy Research (CCER)

> Eindhoven University of Technology (TU/e)

## Overview

This capsule includes the training process of AqSolPred (Aqueous solubility prediction model). AqSolPred is a consensus model that consists of 3 ML models (Neural Nets, Random Forest, and XGBoost).

## How to Run

To start the process simply click the "Reproducible Run" button located at the top right corner.

Run button executes "calculate_sds" and "aqsolpred_cv.py" files, respectively. (takes 10 mins for full run) 

"calculate_sds" calculates the SD of each source datasets (A to I) based on multiple instances (interlab values).

"aqsolpred_cv.py" makes 4-fold cross-validation on dataset-E), to run LOO(leave-one-out) update the file with "n_splits=len(selected_data_test)". However, it will take around 40 hours. Therefore to reproduce LOO results, please download the capsule and run on your own computer/supercomputer.

To reproduce the test results on full dataset-E, change the commmand in "run.sh" file to 'python -u "aqsolpred.py"'

## Contents of Capsule

The capsule consists of 5 python files and 12 data files.

#### Python Files
1. **calculate_sds.py** - Main file that that calculates SDs of each sub-dataset. 
2. **aqsolpred.py**     - Main file that includes preprocessing, training and testing processes. (Tests on whole dataset-E)
3. **aqsolpred_cv.py**  - Main file that includes preprocessing, training and testing processes. (Cross-validates on whole dataset-E)
4. **preprocess.py**    - Includes preprocess functions such as data cleaning, feature extraction and selection
5. **utilities.py**     - Includes usefull functions that generate and plot the descriptors

#### Data Files
Data files are subset of AqSolDB [1] which is generated by the code available in AqSolDB codeocean capsule [2]. 

1. **multiple_data.csv**  - Contains solubility values for the molecules having multiple occurances among the sub-dataset (used for SD estimation).   
2. **dataset-all.csv**    - Full set of AqSolDB [2].   
3. **dataset-not-FA.csv** - Newly generated subset of AqSolDB excluding dataset-A and dataset-F using the same curation method described in [2].
4. **dataset-E.csv**      - Sub-dataset of AqSolDB well-known as "Huuskonen dataset" used as test set (original source [3])
5. **remaining datasets** - Other sub-datasets of AqSolDB.   

#### Output Files
1. **result_cv4.csv"**     -Result file that includes the prediction results of each model including the consensus model. (for 4-fold cv)
2. **result.csv"**         -Result file that includes the prediction results of each model including the consensus model. (for full test)
3. **sd_dataset.csv"**     -Result file that includes D's of each sub-dataset
4. **sd_dataset.png"**     -Bar chart shows SD's of each sub-dataset

## Dependencies
- rdkit==2019-09-3 (requires "conda install -c conda-forge rdkit=2019-09-3")
- scikit-learn==0.22.2.post1
- scipy==1.4.1
- seaborn==0.10.0
- matplotlib==3.1.3
- mordred==1.2.0
- pandas==1.0.1
- xgboost==1.0.2
- numpy==1.18.1

## License and Copyright
MIT License

Copyright (c) 2020 Murat Cihan Sorkun

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

## References

[1] Sorkun, M. C., Khetan, A., & Er, S. (2019). AqSolDB, a curated reference set of aqueous solubility and 2D descriptors for a diverse set of compounds. Scientific data, 6(1), 1-8.

[2] Sorkun, M. C., Khetan, A. & Er, S. AqSolDB (Aqueous Solubility Data Curation). Code Ocean, https://doi.org/10.24433/CO.1992938.v1 (2019).

[3] Huuskonen, J. Estimation of aqueous solubility for a diverse set of organic compounds based on molecular topology. Journal of Chemical Informationand Computer Sciences 40, 773â€“777 (2000).




